# DCNYC Project Plan

This document outlines the plan for building the DCNYC website, a platform for reviewing Diet Coke quality at restaurants in New York City.

## 1. Core Features

- **Map-based Exploration:** A map of NYC displaying all reviewed restaurants with their average Diet Coke rating.
- **Restaurant Reviews:** Users can add reviews for restaurants, including a rating (1-5) and the style of Diet Coke (e.g., fountain, can, bottle).
- **Restaurant Pages:** Each restaurant will have a dedicated page with its details and a list of all its reviews.
- **Adding New Restaurants:** If a restaurant isn't in our database, users can add it when they leave a review.

## 2. Tech Stack

- **Framework:** [Next.js](https://nextjs.org/) (App Router)
- **Styling:** [Tailwind CSS](https://tailwindcss.com/)
- **Database:** [Supabase](https://supabase.com/) (for PostgreSQL database and autogenerated APIs)
- **Mapping:**
    - [React Leaflet](https://react-leaflet.js.org/) for rendering the map.
    - [OpenStreetMap](https://www.openstreetmap.org/) for map tiles.
- **Geocoding:** [Nominatim](https://nominatim.org/): To convert addresses into latitude/longitude for map placement.

## 3. Data Models

We'll use two main tables in our Supabase database.

### `restaurants`

| column      | type        | description                               |
|-------------|-------------|-------------------------------------------|
| `id`        | `uuid`      | Primary key.                              |
| `name`      | `text`      | Name of the restaurant.                   |
| `address`   | `text`      | Physical address.                         |
| `lat`       | `float8`    | Latitude for map plotting.                |
| `lng`       | `float8`    | Longitude for map plotting.               |
| `created_at`| `timestamptz`| Timestamp of when the restaurant was added.|

### `reviews`

| column          | type        | description                                   |
|-----------------|-------------|-----------------------------------------------|
| `id`            | `uuid`      | Primary key.                                  |
| `restaurant_id` | `uuid`      | Foreign key to `restaurants.id`.              |
| `rating`        | `int2`      | Rating from 1 to 5.                           |
| `style`         | `text`      | e.g., 'fountain', 'can', 'bottle', 'gun'. |
| `notes`         | `text`      | Optional user notes about the review.         |
| `created_at`    | `timestamptz`| Timestamp of when the review was created.     |

## 4. Development Roadmap

1.  **Project Setup:**
    - Initialize a new Next.js project. (Done)
    - Configure Tailwind CSS. (Done)
    - Set up a new project on Supabase and create the `restaurants` and `reviews` tables. (Done by user)
    - Create Supabase client. (Done)

2.  **Homepage - Map View:**
    - Create the main page at `app/page.tsx`. (Done)
    - Implement the Leaflet map, displaying a marker for each restaurant. (In Progress)
    - Fetch restaurant data from Supabase using a server component.
    - Marker popups will show the restaurant's name and average rating.

3.  **Add Review Flow:**
    - Create a server action to handle adding new reviews.
    - The form will allow users to search for an existing restaurant or add a new one.
    - If adding a new restaurant, use the Nominatim API to geocode the address.
    - The server action will insert the new data into the database and revalidate Next.js's cache to show the new review instantly.

4.  **Restaurant Detail Page:**
    - Create a dynamic route `app/restaurants/[id]/page.tsx`.
    - Display detailed information for a single restaurant.
    - List all reviews for that restaurant. 